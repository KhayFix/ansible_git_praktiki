# Git

## Зачем

Мы храним в git-репо наши инструменты: проекты Ansible, Terraform, и даже эту документацию.  
Git дает нам  следующие возможности:  

* **Версионность изменений**  
    Позволяет нам вносить правки осмысленными частями(коммитами).  
    Вся история коммитов всегда доступна для просмотра и поиска.  
* **Обратимость изменений**  
    Мы всегда можем откатить до определенного коммита как весь репозиторий, так и только несколько файлов.  
    Работает поиск по изменениям, и мы всегда можем найти коммит, в котором были внесены те или иные изменения.  
* **Независимость изменений**  
    До момент слияния нашей ветки с другой веткой мы не испытываем никакого влияния изменений из других веток.
* **CI**  
    Мы можем прогонять автоматизированные действия как на каждый коммит, так и при определенных условиях.  
    Это позволяет реализовать различные автотесты и автовыкладки.  
* **Ревью изменений**  
    Позволяет нам удобно проводить коллективную оценку изменений перед их слиянием с другими ветками.

## Как

## Инструменты и примеры

### Схлопнуть несколько локальных коммитов в один

насчет сжатия коммитов:
1) сделай git log -10, посчитай кол-во коммитов, которое ты хочеть сжать (в твоем случае - 5)  
имей ввиду, что в этой последовательности не может быть мердж-коммитов, иначе все порастет пиздой  
2) сделай git rebase -i HEAD~N, где N - кол-во коммитов на сжатие  
3) откроется редактор  с редактированием списка коммитов  
     верхний коммит не трогай, а для всех остальных замени pick на s  
     сохраняй, выходи  
4) откроется редактор сообщения коммита, используй творческую силу, сохраняй, выходи  
5) ебашь git log -10, проверяй, что со всем согласен  
6) еще раз проверь ветку, на которой стоишь: это должна быть та самая ветка, и ни в коем случае НЕ МАСТЕР  
7) делай git push, и его должно объебнуть, мол история изменений расходится  
8) делай git push —force, и после этого проверяй в веб-версии, что все изменилось так, как ты хотел  

### Найти правки в строках N1-N2 файле X

Знаем, что в строках 6-8 файла README были правки, которые нам все сломали.  
Ищем коммиты, которые меняли эти строки:  

```bash
git blame -L 6,8 README.md 
^756c345 (Sergei Mikhailov 2019-11-07 19:00:13 +0300 6) 
e0b9f53a (Sergei Mikhailov 2019-11-08 12:07:32 +0300 7) ## Ручной запуск тестов
e0b9f53a (Sergei Mikhailov 2019-11-08 12:07:32 +0300 8) 
```

Смотрим информацию по коммиту:  

```bash
git show e0b9f53a README.md 
commit e0b9f53a7e461053f7bf099231bf6a35dfbc1c1b (HEAD -> feature/common-pain, origin/feature/common-pain)
Author: Sergei Mikhailov <s.mikhaylov@rtk-dc.ru>
Date:   Fri Nov 8 12:07:32 2019 +0300

    Basic lint

diff --git a/README.md b/README.md
index a89f606..cc1bcc5 100644
--- a/README.md
+++ b/README.md
@@ -1,6 +1,12 @@
 # StyleConvention
 
-В это репо живут наши соглашения о работе с различными инструментами.   
+В это репо живут наши соглашения о работе с различными инструментами.  
 Правки применяются только через Merge Request с апрувом(посредством емодзи) от большинства сотрудников.  
 За корректностью разметки и текстов приглядыют автотесты.
 
+## Ручной запуск тестов
+
+### markdownlint
+
+`docker run -it -v "$PWD:/code" pipelinecomponents/markdownlint:5d96213 mdl -s md.rb -w .`
```

### Откатить файл X на коммит Y

### Подтянуть себе правки из мастера и порешать конфликты
